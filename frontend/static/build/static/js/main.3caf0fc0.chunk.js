(this.webpackJsonpstatic=this.webpackJsonpstatic||[]).push([[0],{27:function(t,e,a){t.exports=a(56)},32:function(t,e,a){},54:function(t,e,a){},55:function(t,e,a){},56:function(t,e,a){"use strict";a.r(e);var s=a(0),n=a.n(s),o=a(18),l=a.n(o),i=(a(32),a(3)),r=a(19),c=a(20),u=a(25),m=a(21),d=a(4),g=a(26),h=a(5),_=a.n(h),p=(a(49),a(22)),f=a(23),v=a(24),b=a.n(v),y=(a(54),function(t){var e={backgroundImage:"url(".concat(t.item.album.images[0].url,")")},a={width:100*t.progress_ms/t.item.duration_ms+"%"};return n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"main-wrapper"},n.a.createElement("div",{className:"now-playing__img"},n.a.createElement("img",{alt:"This should be the album art for the current playback",src:t.item.album.images[0].url})),n.a.createElement("div",{className:"now-playing__side"},n.a.createElement("div",{className:"now-playing__name"},t.item.name),n.a.createElement("div",{className:"now-playing__artist"},t.item.artists[0].name),n.a.createElement("div",{className:"now-playing__status"},t.is_playing?"Playing":"Paused"),n.a.createElement("div",{className:"progress"},n.a.createElement("div",{className:"progress__bar",style:a}))),n.a.createElement("div",{className:"background",style:e})," "))});a(55);_.a.defaults.xsrfCookieName="csrftoken",_.a.defaults.xsrfHeaderName="X-CSRFToken";var E=new b.a,N=function(t){function e(t){var a;return Object(r.a)(this,e),(a=Object(u.a)(this,Object(m.a)(e).call(this,t))).state={token:null,item:{album:{images:[{url:""}]},name:"",artists:[{name:"",id:""}],duration_ms:0},is_playing:"Paused",progress_ms:0,root_artists:[],root_artists_selected:[],use_now_playing:!1,use_top_artists:!1,root_artists_selection_complete:!1,latitude:0,longitude:0,zipcode:0,use_zipcode:!1,use_latlong:!1,artists_all:[],artists:[],events_all:[],events_artists:[],events:[],matches:[],songs:[]},a.getNowPlaying=a.getNowPlaying.bind(Object(d.a)(a)),a.useTopArtists=a.useTopArtists.bind(Object(d.a)(a)),a.useNowPlaying=a.useNowPlaying.bind(Object(d.a)(a)),a.selectArtist=a.selectArtist.bind(Object(d.a)(a)),a.useMyLocation=a.useMyLocation.bind(Object(d.a)(a)),a.findEvents=a.findEvents.bind(Object(d.a)(a)),a.addNowPlayingToList=a.addNowPlayingToList.bind(Object(d.a)(a)),a}return Object(g.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t,e=this;this.state.token||_.a.get("/api/v1/user-social-auth/").then((function(a){t=a.data[0].extra_data.access_token,e.setState({token:t}),E.setAccessToken(t),e.getNowPlaying()})).catch((function(t){console.log(t)}))}},{key:"getNowPlaying",value:function(){var t=this;E.getMyCurrentPlaybackState().then((function(e){e&&t.setState({item:e.item,is_playing:e.is_playing,progress_ms:e.progress_ms,use_now_playing:!1}),console.log(e)})).catch((function(e){console.log(e),t.setState({item:{album:{images:[{url:""}]},name:"",artists:[{name:"",id:""}],duration_ms:0},is_playing:"Spotify Not Currently in use",progress_ms:0})}))}},{key:"useNowPlaying",value:function(){var t=this;E.getArtistRelatedArtists(this.state.item.artists[0].id).then((function(e){t.setState({root_artists:e.artists,use_now_playing:!0,use_top_artists:!1}),console.log(e)})).catch((function(t){return console.log(t)})),E.getArtist(this.state.item.artists[0].id).then((function(t){console.log(t)})).catch((function(t){console.log(t)}))}},{key:"useTopArtists",value:function(){var t=this;E.getMyTopArtists().then((function(e){t.setState({root_artists:e.items,use_top_artists:!0,use_now_playing:!1})})).catch((function(t){console.log(t)}))}},{key:"addNowPlayingToList",value:function(){var t=new FormData;t.append("title",this.state.item.name),t.append("artist",this.state.item.artists[0].name),t.append("url",this.state.item.href),t.append("track_number",this.state.songs.length),t.append("duration_ms",this.state.item.duration_ms),localStorage.setItem("formData",JSON.stringify(t)),localStorage.setItem("state-addnowplaying",JSON.stringify(this.state)),console.log(t),_()({method:"post",url:"/api/v1/songs/",config:{headers:{"content-type":"multipart/form-data"}},data:t}).then((function(){console.log("Current song added to song list!")})).catch((function(t){console.log(t)}))}},{key:"selectArtist",value:function(t){if(this.state.root_artists_selected.includes(t)){var e=Object(i.a)(this.state.root_artists_selected);e.splice(e.indexOf(t),1),this.setState({root_artists_selected:e})}else{var a=Object(i.a)(this.state.root_artists_selected);a.push(t),this.setState({root_artists_selected:a})}}},{key:"useMyLocation",value:function(t){t.preventDefault();var e=this;navigator.geolocation.getCurrentPosition((function(t){console.log("latitude",t.coords.latitude,"longitude",t.coords.longitude),e.setState({latitude:t.coords.latitude,longitude:t.coords.longitude})}),(function(t){console.error("An error has occured while retrieving location",t)}))}},{key:"findEvents",value:function(){var t=this;_()({method:"get",url:"https://api.songkick.com/api/3.0/events.json?apikey=".concat("io09K9l3ebJxmxe2","&location=geo:").concat(this.state.latitude,",").concat(this.state.longitude,"&page=1")}).then((function(e){if(console.log(e),t.setState({events_all:e.data.resultsPage.results.event}),e.data.resultsPage.totalEntries>e.data.resultsPage.results.event.length&!0){var a=e.data.resultsPage.totalEntries,s=e.data.resultsPage.perPage;console.log("There are ".concat(a," results and ").concat(s," on each page")),console.log("Which means the site needs to make ".concat(Math.ceil(a/s)," calls total")),console.log("and the last call should have ".concat(a%s," entries"));var n,o=Math.ceil(a/s);for(n=1;n<o;n++)_()({method:"get",url:"https://api.songkick.com/api/3.0/events.json?apikey=".concat("io09K9l3ebJxmxe2","&location=geo:").concat(t.state.latitude,",").concat(t.state.longitude,"&page=").concat(n+1)}).then((function(e){var a,s=Object(i.a)(t.state.events_all);s=s.concat(e.data.resultsPage.results.event),t.setState({events_all:s});var n=Object(i.a)(t.state.events_artists);for(a=0;a<t.state.events_all.length;a++){var o=t.state.events_all[a],l=void 0;for(l=0;l<o.performance.length;l++)n.includes(o.performance[l].artist)||n.push(o.performance[l].artist)}t.setState({events_artists:n})})).catch((function(t){console.log(t)}))}var l,r=Object(i.a)(t.state.events_artists);for(l=0;l<t.state.events_all.length;l++){var c=t.state.events_all[l],u=void 0;for(u=0;u<c.performance.length;u++)r.push(c.performance[u].artist)}t.setState({events_artists:r})})).catch((function(t){console.log(t)}))}},{key:"findArtists",value:function(){var t,e=this;for(t=0;t<this.state.root_artists_selected.length;t++)E.getArtistRelatedArtists(this.state.root_artists_selected[t].id).then((function(t){var a=Object(i.a)(e.state.artists_all);a=a.concat(t.artists),e.setState({artists_all:a}),console.log(t)})).catch((function(t){console.log(t)}))}},{key:"findMatches",value:function(){console.log("There are ".concat(this.state.events_artists.length," artists from events"));var t=Object(i.a)(this.state.events_artists),e=Object(i.a)(new Set(t.map((function(t){return t.displayName}))));console.log("".concat(e.length," are unique")),console.log("There are ".concat(this.state.artists_all.length," artists from events"));var a=Object(i.a)(this.state.artists_all),s=Object(i.a)(new Set(a.map((function(t){return t.name}))));console.log("".concat(s.length," are unique"));var n,o,l,r=[];for(n=0;n<s.length;n++)for(l=s[n],o=0;o<e.length;o++)l===e[o]&&r.push(l);console.log("and there are ".concat(r.length," matches")),console.log(r),this.setState({matches:r})}},{key:"render",value:function(){var t=this,e=this.state.root_artists.map((function(e,a){return n.a.createElement("button",{key:a,className:"btn root-artist-btn ".concat(t.state.root_artists_selected.includes(e)?"btn-selected":""),onClick:function(){return t.selectArtist(e)}},e.name)}));this.state.events.map((function(t,e){return n.a.createElement("div",{key:e,className:"btn m-2"},t.something)}));return n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"App-header"},n.a.createElement("nav",{className:"scrollspy-placeholder"},n.a.createElement("ul",null)),this.state.token&&n.a.createElement("div",{className:"position-fixed fixed-top d-flex flex-row-reverse"},n.a.createElement("a",{href:"/logout/",className:"logout-btn btn m-3"},"Logout")),!this.state.token&&n.a.createElement("div",null,n.a.createElement("a",{className:"btn btn--loginApp-link",href:"/social/login/spotify/"},"Login to Spotify")),this.state.token&&n.a.createElement("div",null,n.a.createElement("div",{className:"player-wrapper"},this.state.item.album.images[0].url?n.a.createElement(y,{item:this.state.item,is_playing:this.state.is_playing,progress_ms:this.state.progress_ms}):n.a.createElement("div",null,n.a.createElement("div",null,"Let's get started."),n.a.createElement("div",null,"To make sure your Spotify is connected, play a song (on your phone, or any device) and hit the resync button to make sure you're connected")),n.a.createElement("button",{className:"btn p-1 refresh-btn",onClick:function(){return t.getNowPlaying()}},n.a.createElement("span",{className:"p-1"},n.a.createElement(p.a,{icon:f.a})))),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("button",{className:"btn ".concat(this.state.use_now_playing?"btn-selected":""," "),onClick:function(){return t.useNowPlaying()}},"Use Artists Related to Now Playing"),n.a.createElement("button",{className:"btn ".concat(this.state.use_top_artists?"btn-selected":""," "),onClick:function(){return t.useTopArtists()}},"Use Your Top Artists")),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",{className:"".concat(this.state.use_now_playing||this.state.use_top_artists?"d-flex align-items-center":"d-none"," ")},n.a.createElement("div",null,n.a.createElement("button",{className:"btn",onClick:function(){return t.setState({root_artists_selected:t.state.root_artists})}},"All"),n.a.createElement("button",{className:"btn",onClick:function(){return t.setState({root_artists_selected:[]})}},"None")),n.a.createElement("div",null,e)),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",{className:"".concat(this.state.use_now_playing||this.state.use_top_artists?"d-flex align-items-center":"d-none"," ")},n.a.createElement("h2",{className:"m-2"},"Select at least 3 starting bands to continue"),n.a.createElement("button",{onClick:function(){t.state.root_artists_selected.length>=3&&t.setState({root_artists_selection_complete:!0})},className:"".concat(this.state.root_artists_selected.length>=3?"btn":"btn-disabled"," ").concat(this.state.root_artists_selection_complete?"btn-selected":"")},"Continue Using These Bands")),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",{className:"location ".concat(this.state.root_artists_selection_complete?"d-flex":"d-none")},n.a.createElement("div",{className:"d-flex flex-column justify-content-left"},n.a.createElement("div",{className:" ".concat("geolocation"in navigator?"d-flex flex-column":"d-none")},n.a.createElement("button",{className:"btn",onClick:this.useMyLocation},"Find My Location"),n.a.createElement("p",null,"~or~")),n.a.createElement("div",null,"Please enter your zip code: ",n.a.createElement("input",{type:"text"}))),n.a.createElement("div",null,this.state.latitude,", ",this.state.longitude)),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",{className:" ".concat(this.state.root_artists_selection_complete&&0!==this.state.latitude?"d-flex flex-column":"d-none")},"Let's do the thing",n.a.createElement("br",null),n.a.createElement("button",{className:"btn",onClick:function(){return t.findEvents()}},"Find Events"),"# of events found: ",this.state.events_all.length," ",n.a.createElement("br",null),"# of artist from those events: ",this.state.events_artists.length,n.a.createElement("button",{className:"btn",onClick:function(){return t.findArtists()}},"Find Artists"),n.a.createElement("br",null),"# of artists found: ",this.state.artists_all.length,n.a.createElement("br",null),n.a.createElement("button",{className:"btn",onClick:function(){return t.findMatches()}},"Find Matches"),"# of matches found: ",this.state.matches.length)))}}]),e}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[27,1,2]]]);
//# sourceMappingURL=main.3caf0fc0.chunk.js.map